## Lippia Web sample project

## Purpose
This project has the intention of show in a practical way how to use Lippia Automation Framework to build automated tests using Gherkin and Page-Object pattern. This sample project includes the required components as binaries, docker containers and configuration files to simply download and run a set of sample tests in your local computer, using the Lippia container stack described bellow.

## System Requirements :
+ JDK 8: https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html   
	  https://openjdk.java.net/install/   
+ maven 3.X: https://maven.apache.org/download.cgi   
+ docker 18.09: https://docs.docker.com/install/linux/docker-ce/ubuntu/
+ docker compose 1.24: https://docs.docker.com/compose/install/

# Getting started
 [Download]: <https://bitbucket.org/crowdarautomation/lippia-web-example-project/get/fdc35889edbf.zip>
- [Download] and unzip the source repository for this guide, or clone it using Git:
    ``` $ git clone https://bitbucket.org/crowdarautomation/lippia-web-example-project.git ```
- Go to root directory  
    ``` $ cd lippia-web-example-project ```


## Strategies to run
- [Stack](#sarasa) (running docker-compose and only clicking "Build job" on jenkins)  
- [Local](#local) (running tests building project with maven from command line)


#### Local strategy
##### Executing tests in you local machine from command line
- From command line run the following command to execute tests:
   ```
  $ mvn clean test
  ```
*mostrar que pasa en la consola*
> To see the result, go to the [report section](#Report) below.

#### Stack strategy
This strategy use docker containers to generate a context to execute the tests.
Through docker compose we configure the following:
- Jenkins
- Selenium hub
- Browser nodes

##### Starting stack over linux
To start the containers, simply run the following command from terminal:
    ```
    $ sudo docker-compose up --scale chrome=2
    ```

> This command, will start download the images needed to build all the containers and start them. It takes a while to download the images depending on your internet connection.
You can change the number of instances to start from chrome by modifying the values of the "scale" parameter
for example: `-scale chrome=9` (creating 9 chrome instances)

After that you you can check the containers are up and running executing the following command
`$ sudo docker ps `.
    You have to see 2 Chrome Browsers, 1 Selenium Grid and 1 Jenkins.

```
CONTAINER ID        IMAGE                                     COMMAND                  CREATED             STATUS              PORTS                                                                      NAMES
lippia-web-example-project_chrome_1
0f69715cd500        selenium/node-chrome:3.141.59-palladium   "/opt/bin/entry_poin…"   6 minutes ago       Up 5 minutes                                       lippia-web-example-project_chrome_2
29d29f842f47        selenium/node-chrome:3.141.59-palladium   "/opt/bin/entry_poin…"   6 minutes ago       Up 5 minutes                                    
lippia-web-example-project_chrome_3
bd442e21a088        selenium/node-chrome:3.141.59-palladium   "/opt/bin/entry_poin…"   6 minutes ago       Up 5 minutes                                                                                   0.0.0.0:4444->4444/tcp                                                     selenium-hub
b2f7325d2fc5        jenkinsci/blueocean:1.18.0                "/sbin/tini -- /usr/…"   6 minutes ago       Up 6 minutes        0.0.0.0:8080->8080/tcp, 0.0.0.0:8443->8443/tcp, 0.0.0.0:50000->50000/tcp   lippia-web-example-project_jenkins_1

```



#### Starting Docker stack over Windows
If you use Microsoft Windows, open a console (remember to chose **Run as administrator**)

- run the following command wait to virtualbox instance start, this operation will be take several minutes. This will provision the Docker containers inside a Virtual Box managed by Vagrant.
`vagrant up --provision `

*pegar imagen de consola de Windows con Vagrant*

- to end vagrant execute
`vagrant halt`

To access to vagrant virtual context execute
- `vagrant ssh`
> This command enables to enter via ssh to virtual machine
> Now you can execute the same commands that you would execute while in a linux environment
> For example: `$ docker ps`


## Check Docker stack is up and running
After starting the stack you can see  and selenium grid following url:
Jenkins: http://localhost:8080

*Pegar imagen del jenkins*

Selenium Grid: http://localhost:4444/grid/console

*Pegar imagen del grid condsole*

Also you can find the Extent report generated by Lippia in
### Run from Jenkins with Selenium Grid

Enter Jenkins console http://localhost:8080 with the following credentials
Username: **admin**
Password: **secret**

*Pegar imagen del job del jenkins*

### Docker stack

The following project includes the basic Docker Lippia Containers to run this  web sample project. You can choose to run the code from your favourite IDE, run from console or from Jenkins using the Docker Stack.
To install and start a local instalation with Docker containers following the ![Lippia Docker Web Readme] https://bitbucket.org/crowdarautomation/lippia-web-example-project/src/lippia_docker_web_readme.md

## Project structure

A typical Lippia Test Automation project usually looks like this

```
	.
├── main
│   ├── java
│   │   └── com
│   │       └── crowdar
│   │           └── examples
│   │               ├── pages
│   │               │   ├── Inicio.java
│   │               │   └── PageBaseExamples.java
│   │               └── steps
│   │                   └── InicioSteps.java
│   └── resources
│       ├── config.properties
│       ├── cucumber.properties
│       └── webdrivermanager.properties
└── test
    ├── java
    │   ├── CrowdTestNgParallelRunner.java
    │   ├── CrowdTestNgRunner.java
    │   └── com
    │       └── crowdar
    │           ├── Hooks.java
    └── resources
        └── features
            └── Inicio.feature
```

Folder's description:

|Path   |Description    |
|-------|----------------|
|main\java\\...\examples\pages\\\*.java|Folder with all the **PageObjects** matching steps with java code|
|main\java\\...\examples\steps\\\*Steps.java|Folder with all the **steps** wich match with Gherkin Test Scenarios |
|test\resources\features\\\*.feature|Folder with all the **feature files** containing **Test Scenarios** and **Sample Data** |
|main\resources|Folder with all configuration needed to run Lippia |

In this example, *Inicio* is the first web page the framework will interact with. The **steps** defined in *InicioSteps.java* to execute the *Test Scenarios* defined in Gherkin language.


|File   | Description    |
|-------|----------------|
|Inicio.java   | PageObject: between each element in the webpage *Inicio* you want to interact with. You need to add one new file for each page you want to navigate in your tests. |
|InicioSteps.java   | StepOpject: Code to support the behaviour of each **step** coded into the feature files for the *Inicio* web page. This code executes the interaction between the Framework and the web application and match the steps with the code who run interactions. |
|Inicio.feature| Feature file: Definition of the **Test Scenarios** with all the **steps** written in Cucumber format (http)|


### Page Object

Descripcion de la clase page object

```
   public Inicio(SharedDriver driver){
        super(driver);
        this.url = "";
    }

    public void navegarAlInicio(){
        navigateToIt();
    }
```

### Step Opject


### Feature File

The Test Scenarios can be written using BDD metodology. This project includes Cucumber as BDD interpreter which is supported by Lippia by default. On each declared step you can insert the calls defined from service classes

![Lippia gherkin Web](https://bitbucket.org/crowdarautomation/lippia-web-example-project/raw/805effb96e514985af2815aa89a1537bb4fe44ba/gherkin.png =100x)


### Reports

By default Lippia expose Test results using Extent Report Community Edition (https://github.com/extent-framework)
In order to see test results this project includes extent report that show you the result of each run. This kind of reporting is really easy to understand.
You just need to open it and navigate for all the report page to earn the much information as you can for every run.

![Lippia Extent Report](https://bitbucket.org/crowdarautomation/lippia-web-example-project/raw/805effb96e514985af2815aa89a1537bb4fe44ba/reporteExtent.png)

you can view this report by accesing to:

- `/jenkins_home/workspace/nd-volume-needed-for-example-job/target/cucumber-report/example.html`
